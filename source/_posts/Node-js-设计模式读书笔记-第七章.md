---
title: 《Node.js 设计模式》读书笔记 第七章
date: 2018-07-28 23:36:33
tags:
    - 读书笔记
---

# Wiring Modules(连接模块)

对模块常见的一个问题就是：将组件 X 的实例传递到模块 Y 的最佳方式是什么？

常见的模式有一下几种：

- 硬编码依赖
- 依赖注入
- 服务定位器
- 依赖注入容器

<!-- more -->

## Modules and dependencies(模块和依赖)

### The most common dependency in Node.js(Node.js 中最常见的模块)

一个模块的属性可以概括如下：

- 一个模块应该具有可读性和可理解性，因为它应该专注于一件事。
- 一个模块被表示为一个单独的文件，使得其更容易被识别。
- 模块可以更容易地在不同的应用程序中复用。

### Cohesion and coupling(内聚和耦合)

评判创建的模块平衡性两个最重要的特征就是内聚度和耦合度。这两个特征可以应用于软件体系结构中的任何类型的组件或子系统。因此在构建 `Node.js` 模块时也可以把这两个特征作为重要的参考价值。这两个属性定义如下：

内聚度：用于度量模块内部功能之间的相关性。例如，对于一个只做一件事的模块，其中的所有部件都只对这一件事起作用，那说明这个模块具有很高的内聚度。举个例子，那种包含把任何类型的对象存储到数据库的函数内聚度就较低，如 `saveProduct()`、`saveInvoice()`、`saveUser()` 等。

耦合度：评判模块对系统其他模块的依赖程度。例如，当一个模块直接读取或修改另一个模块的数据时，该模块与另一个模块是紧密耦合的；另外，通过全局或共享状态交互的两个模块也是紧密耦合的；另一方面，仅通过参数传递进行通信的两个模块耦合度较低。

理想情况下，一个模块应该具有较高的内聚度和较低的耦合度，这样的模块更易于理解、重用和扩展。

### Stateful modules(有状态的模块)

在 `JavaScript` 中，将接口与实现分离的例子很少。 然而，通过使用 `Node.js` 模块系统，我们引入了一个特定的模块，接口不会受到其它模块的影响。在正常情况下，这没有什么问题，但是如果我们使用 `require()` 来加载一个导出有状态实例的模块，比如数据库交互对象，`HTTP` 服务器实例，乃至普通的任何对象这不是无状态的，我们实际上是在引用的模块都是一个又一个的单例，因此模块系统有着单例模式的优点和缺点，此外，也有一些不同的地方。

#### The Singleton pattern in Node.js(Node.js 中的单例模式)


